import{r as e,j as f}from"./jsx-runtime-BfF-YriY.js";import{g as Y,f as K,T as q,L as U,t as Z}from"./image-D0V8Py5W.js";import{W as $,e as J,A as O,f as Q,S as ee,g as te,G as re,h as se,D as y,r as ne,c as oe,a as ae,m as ce,i as ie}from"./three-D2cv32zP.js";import{b as ue,a as le,c as de,n as me}from"./style-DceWDdse.js";import{t as fe}from"./throttle-BgiUmwhn.js";import{u as E}from"./use-spring-DxnKqeE8.js";import"./components-Dn-xNZAJ.js";import"./index-Wip2jntP.js";const pe="/MyPortfolio/assets/volkihar-cube-nx-B7Zjde9E.jpg",ve="/MyPortfolio/assets/volkihar-cube-ny-K8Ej-0KC.jpg",he="/MyPortfolio/assets/volkihar-cube-nz-CwSlGC5m.jpg",ge="/MyPortfolio/assets/volkihar-cube-px-B6VuHL6s.jpg",be="/MyPortfolio/assets/volkihar-cube-py-nbSfCjcD.jpg",we="/MyPortfolio/assets/volkihar-cube-pz-Bzqv8d-T.jpg",ye="/MyPortfolio/assets/volkihar-knight-BtFNLzdG.glb",xe="_armor_1taf3_1",Le="_loader_1taf3_13",Me="_canvas_1taf3_31",x={armor:xe,loader:Le,canvas:Me},C={stiffness:40,damping:20,mass:1.5},Pe=({showDelay:T=0,cameraPosition:p={x:0,y:0,z:6},className:z,alt:P,...G})=>{const[L,_]=e.useState(!1),[V,A]=e.useState(!1),[B,N]=e.useState(!1),u=e.useRef(),M=e.useRef(),l=e.useRef(),c=e.useRef(),n=e.useRef(),t=e.useRef(),v=e.useRef(),h=Y(u,!1,{threshold:.4}),k=K(),g=E(0,C),b=E(0,C);e.useEffect(()=>{const{clientWidth:r,clientHeight:s}=u.current;t.current=new $({canvas:M.current,alpha:!0,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),t.current.setPixelRatio(2),t.current.setSize(r,s),t.current.outputColorSpace=J,t.current.toneMapping=O,l.current=new Q(36,r/s,.1,100),l.current.position.set(p.x,p.y,p.z),n.current=new ee;const o=new te;c.current=new re,n.current.add(c.current);const i=new se(t.current);i.compileCubemapShader();const m=new y(16777215,2.6),j=new y(16777215,1),S=new y(16777215,1.3);m.position.set(1,.1,2),j.position.set(-1,.1,8),S.position.set(-2,2,-3),v.current=[S,m,j],v.current.forEach(a=>n.current.add(a));const W=async()=>{const a=ce.loadAsync(ye),F=o.loadAsync([pe,ve,he,ge,be,we]),[w,I]=await Promise.all([a,F]);c.current.add(w.scene),w.scene.rotation.y=ie.degToRad(180),w.scene.position.y=-1.6;const{texture:X}=i.fromCubemap(I);n.current.environment=X,i.dispose(),await t.current.initTexture(n.current.environment),c.current.traverse(async R=>{R.material&&await t.current.initTexture(R.material)}),_(!0),d()};e.startTransition(()=>{W(),setTimeout(()=>{N(!0)},1e3)});const H=g.on("change",a=>{c.current.rotation.x=a,d()}),D=b.on("change",a=>{c.current.rotation.y=a,d()});return()=>{ne(v.current),oe(n.current),ae(t.current),H(),D()}},[]);const d=e.useCallback(()=>{t.current.render(n.current,l.current)},[]);return e.useEffect(()=>{const r=fe(s=>{const{innerWidth:o,innerHeight:i}=window,m={x:(s.clientX-o/2)/o,y:(s.clientY-i/2)/i};g.set(m.y/2),b.set(m.x/2)},100);return h&&A(!0),h&&!k&&window.addEventListener("mousemove",r),()=>{window.removeEventListener("mousemove",r)}},[h,k,g,b]),e.useEffect(()=>{const r=()=>{if(!u.current)return;const{clientWidth:s,clientHeight:o}=u.current;t.current.setSize(s,o),l.current.aspect=s/o,l.current.updateProjectionMatrix(),d()};return window.addEventListener("resize",r),r(),()=>{window.removeEventListener("resize",r)}},[d]),f.jsxs("div",{className:ue(x.armor,z),ref:u,role:"img","aria-label":P,...G,children:[f.jsx(q,{unmount:!0,in:!L&&B,timeout:le(Z.base.durationL),children:({visible:r})=>f.jsx(U,{className:x.loader,"data-visible":r})}),f.jsx("canvas",{className:x.canvas,ref:M,"data-loaded":L&&V,style:de({delay:me(T)})})]})};export{Pe as Armor};
